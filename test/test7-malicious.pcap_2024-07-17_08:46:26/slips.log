2024/07/17 08:46:28.298397 [Main] Using redis server on port: [32m6379[0m
2024/07/17 08:46:28.298705 [Main] Started [32mMain[0m process [PID [32m2919[0m]
2024/07/17 08:46:28.303199 [Main] Started [32mPBar[0m process [PID [32m2929[0m]
2024/07/17 08:46:28.382855 [Main] Starting modules
2024/07/17 08:46:30.167764 [Main] 		Starting the module [32mARP[0m (Detect ARP attacks) [PID [32m3027[0m]
2024/07/17 08:46:30.185779 [Main] 		Starting the module [32mFlow Alerts[0m (Alerts about flows: long connection, successful ssh, password guessing, self-signed certificate, data exfiltration, etc.) [PID [32m3030[0m]
2024/07/17 08:46:30.194508 [Main] 		Starting the module [32mFlow ML Detection[0m (Train or test a Machine Learning model to detect malicious flows) [PID [32m3031[0m]
2024/07/17 08:46:30.195618 [Flow ML Detection] Reading the trained model from disk.
2024/07/17 08:46:30.196211 [Flow ML Detection] Reading the trained scaler from disk.
2024/07/17 08:46:30.203030 [Main] 		Starting the module [32mHTTP Analyzer[0m (Analyze HTTP flows) [PID [32m3032[0m]
2024/07/17 08:46:30.210052 [Main] 		Starting the module [32mIP Info[0m (Get different info about an IP/MAC address) [PID [32m3033[0m]
2024/07/17 08:46:30.216341 [Main] 		Starting the module [32mNetwork Discovery[0m (Detect Horizonal, Vertical Port scans, ICMP, and DHCP scans) [PID [32m3034[0m]
2024/07/17 08:46:30.224284 [Main] 		Starting the module [32mRisk IQ[0m (Module to get passive DNS info about IPs from RiskIQ) [PID [32m3035[0m]
2024/07/17 08:46:30.233087 [Main] 		Starting the module [32mRNN C&C Detection[0m (Detect C&C channels based on behavioral letters) [PID [32m3036[0m]
2024/07/17 08:46:30.265303 [Main] 		Starting the module [32mThreat Intelligence[0m (Check if the source IP or destination IP are in a malicious list of IPs) [PID [32m3134[0m]
2024/07/17 08:46:30.275174 [Main] 		Starting the module [32mTimeline[0m (Creates kalipso timeline of what happened in the network based on flows and available data) [PID [32m3136[0m]
2024/07/17 08:46:30.288426 [Main] 		Starting the module [32mUpdate Manager[0m (Update Threat Intelligence files) [PID [32m3137[0m]
2024/07/17 08:46:30.292493 [Update Manager] Checking if we need to download TI files.
2024/07/17 08:46:30.298739 [Main] 		Starting the module [32mVirustotal[0m (IP, domain and file hash lookup on Virustotal) [PID [32m3138[0m]
2024/07/17 08:46:30.800276 [Main] Disabled Modules: ['template', 'ensembling', 'exporting_alerts', 'p2ptrust', 'cesnet', 'blocking', 'leak_detector', 'cyst']
2024/07/17 08:46:30.812762 [Evidence] Storing Slips logs in output/test7-malicious.pcap_2024-07-17_08:46:26/
2024/07/17 08:46:30.819502 [Main] Started [32mEvidence Process[0m [PID [32m3139[0m]
2024/07/17 08:46:30.831839 [Main] Started [32mProfiler Process[0m [PID [32m3140[0m]
2024/07/17 08:46:30.834145 [Main] Metadata added to output/test7-malicious.pcap_2024-07-17_08:46:26/metadata
2024/07/17 08:46:30.843042 [Main] Started [32mInput Process[0m [PID [32m3141[0m]
2024/07/17 08:46:30.845536 [Main] Warning: Slips may generate a large amount of traffic by querying TI sites.
2024/07/17 08:46:30.848924 [Input] Storing zeek log files in output/test7-malicious.pcap_2024-07-17_08:46:26/zeek_files
2024/07/17 08:46:34.621182 [SymbolHandler] Warning: Coming flows are not sorted -> Some time diff are less than zero.
2024/07/17 08:46:34.944417 [SymbolHandler] Warning: Coming flows are not sorted -> Some time diff are less than zero.
2024/07/17 08:46:35.199152 [SymbolHandler] Warning: Coming flows are not sorted -> Some time diff are less than zero.
2024/07/17 08:46:35.756170 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 51.0.
2024/07/17 08:46:35.775369 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:35.779036 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:35.779268 [Flow ML Detection] Error in train()
2024/07/17 08:46:35.779434 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:36.678313 [SymbolHandler] Warning: Coming flows are not sorted -> Some time diff are less than zero.
2024/07/17 08:46:36.883976 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 101.0.
2024/07/17 08:46:36.900058 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:36.900395 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:36.900570 [Flow ML Detection] Error in train()
2024/07/17 08:46:36.900727 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:37.588112 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 151.0.
2024/07/17 08:46:37.600014 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:37.600464 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:37.600776 [Flow ML Detection] Error in train()
2024/07/17 08:46:37.601073 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:38.326305 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 201.0.
2024/07/17 08:46:38.344039 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:38.344314 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:38.344542 [Flow ML Detection] Error in train()
2024/07/17 08:46:38.344715 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:39.148143 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 251.0.
2024/07/17 08:46:39.167668 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:39.168021 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:39.168355 [Flow ML Detection] Error in train()
2024/07/17 08:46:39.168577 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:39.954554 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 301.0.
2024/07/17 08:46:39.973616 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:39.973918 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:39.974192 [Flow ML Detection] Error in train()
2024/07/17 08:46:39.974365 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:40.779782 [Flow ML Detection] Training the model with the last group of flows and labels. Total flows: 351.0.
2024/07/17 08:46:40.796096 [Flow ML Detection] Error in process_features()
2024/07/17 08:46:40.796470 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 140, in process_features
    dataset = dataset.drop(field, axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4906, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4150, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4185, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6017, in drop
    raise KeyError(f"{labels[mask]} not found in axis")
KeyError: "['flow_type'] not found in axis"

2024/07/17 08:46:40.796820 [Flow ML Detection] Error in train()
2024/07/17 08:46:40.797011 [Flow ML Detection] Traceback (most recent call last):
  File "/StratosphereLinuxIPS/modules/flowmldetection/flowmldetection.py", line 69, in train
    self.flows.label = self.flows.label.str.replace(
AttributeError: 'NoneType' object has no attribute 'label'

2024/07/17 08:46:55.338476 [Update Manager] Connection error while downloading the file https://check.torproject.org/torbulkexitlist. Aborting.
2024/07/17 08:46:55.341371 [Update Manager] 43 TI files successfully loaded.
2024/07/17 08:47:03.857177 [Input] We read everything. No more input. Stopping input process. Sent 541 lines
2024/07/17 08:47:03.857288 [Input] Telling Profiler to stop because no more input is arriving.
2024/07/17 08:47:03.857361 [Input] Waiting for Profiler to stop.
2024/07/17 08:47:03.857535 [Profiler] Stopping. Total lines read: 541
2024/07/17 08:47:03.857658 [Profiler] Marking Profiler as done processing.
2024/07/17 08:47:03.857697 [Profiler] Profiler is done processing.
2024/07/17 08:47:03.857782 [Profiler] Profiler is done telling input.py that it's done processing.
2024/07/17 08:47:03.857790 [Input] Input is done processing.
2024/07/17 08:47:03.857818 [Profiler] Stopping. Total lines read: 541
2024/07/17 08:47:04.285066 [Input] Stopping. Total lines read: 541
2024/07/17 08:47:05.940236 [Main] 
---------------------------
2024/07/17 08:47:05.940498 [Main] Stopping Slips
2024/07/17 08:47:05.960343 [Main] Analysis of dataset/test7-malicious.pcap finished in 0.63 minutes
2024/07/17 08:47:05.960663 [Main] Total flows read (without altflows): 374
2024/07/17 08:47:05.976622 [Main] 	[32mHTTP Analyzer       [0m 	Stopped. [32m13[0m left.
2024/07/17 08:47:05.976840 [Main] 	[32mFlow ML Detection   [0m 	Stopped. [32m12[0m left.
2024/07/17 08:47:05.991185 [Main] 	[32mRNN C&C Detection   [0m 	Stopped. [32m11[0m left.
2024/07/17 08:47:05.991399 [Main] 	[32mARP                 [0m 	Stopped. [32m10[0m left.
2024/07/17 08:47:05.991568 [Main] 	[32mNetwork Discovery   [0m 	Stopped. [32m9[0m left.
2024/07/17 08:47:05.991749 [Main] 	[32mInput               [0m 	Stopped. [32m8[0m left.
2024/07/17 08:47:10.279426 [Main] 	[32mIP Info             [0m 	Stopped. [32m7[0m left.
2024/07/17 08:47:10.279747 [Main] 	[32mProfiler            [0m 	Stopped. [32m6[0m left.
2024/07/17 08:47:10.279964 [Main] 	[32mTimeline            [0m 	Stopped. [32m5[0m left.
2024/07/17 08:47:10.280133 [Main] 	[32mUpdate Manager      [0m 	Stopped. [32m4[0m left.
2024/07/17 08:47:10.280296 [Main] 	[32mThreat Intelligence [0m 	Stopped. [32m3[0m left.
2024/07/17 08:47:10.280466 [Main] 	[32mProgress Bar        [0m 	Stopped. [32m2[0m left.
2024/07/17 08:47:10.280599 [Main] The following modules are busy working on your data.

['Flow Alerts', 'Evidence']

You can wait for them to finish, or you can press CTRL-C again to force-kill.

2024/07/17 08:47:23.052979 [Main] 	[32mFlow Alerts         [0m 	Stopped. [32m1[0m left.
2024/07/17 08:47:23.053444 [Main] 	[32mEvidence            [0m 	Stopped. [32m0[0m left.
2024/07/17 08:47:23.061178 [Main] [Process Manager] Slips shutdown gracefully

